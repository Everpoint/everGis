<!DOCTYPE html>
<html>
<head>
    <title>sGis Framework - Controls Sample</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">

    <style>
        body, html {
            margin: 0px;
            overflow: hidden;
            height: 100%;
        }

        div#map {
            width: 100%;
            height: 100%;
        }
    </style>

    <script src="http://dev2.everpoint.ru/EverGIS/HTML5/006/evergis.js"></script>

</head>
<body>
<div id="map"></div>
<script>
    window.onload = function() {

        var sp = new sGis.SpatialProcessor({
            url: 'http://dev2.everpoint.ru/EverGIS/SpatialProcessor/IIS/', login: 'jspublic', password: 'jspublic',
            mapWrapper: 'map',
            services: ['esri_gray'],
            controllers: ['routing']
        });

        var point = sp.map.position.projectTo(sGis.CRS.webMercator);
        sp.controller.routing.buildRoute({
            startPoint: point,
            endPoint: new sGis.Point(point.x+10000, point.y, sGis.CRS.webMercator),
            solver: '2Gis',
            success: function(features) {
                var featureLayer = new sGis.FeatureLayer();
                featureLayer.add(features);
                sp.map.addLayer(featureLayer);

                sp.controller.routing.buildRoute({
                    startPoint: point,
                    endPoint: new sGis.Point(point.x+10000, point.y, sGis.CRS.webMercator),
                    solver: 'Атлас',
                    success: function(features) {

                    },
                    error: function() {
                        console.log('error');
                    },
                    requested: function() {
                        console.log('requested');
                    }
                });
            },
            error: function() {
                console.log('error');
            },
            requested: function() {
                console.log('requested');
            }
        });

    };
</script>
</body>
</html>
