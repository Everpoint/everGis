<!DOCTYPE html>
<html>
<head>
    <title>sGis Framework - Map Decorations Sample</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <style>
        body, html {
            margin: 0px;
            overflow: hidden;
            height: 100%;
        }

        div#map {
            width: 100%;
            height: 100%;
        }
    </style>

    <script src="http://dev2.everpoint.ru/EverGIS/HTML5/005/evergis.js"></script>


</head>
<body>
    <!--

    -->
    <div id="map"></div>
    <script>
            window.onload = function() {

            //sGis.spatialProcessor.Connector.prototype.apiLoginUrl = 'http://localhost:80/Strategis.JsClient/ApiLogin.aspx';

            //var sp = new sGis.SpatialProcessor({
            //    url: 'http://localhost/spatialProcessor/', login: 'z', password: 'z',
            //    mapWrapper: 'map',
            //    services: ['osm', 'all_dev']
            //});

            var sp = new sGis.SpatialProcessor({
                url: 'http://dev2.everpoint.ru/eg_public/SpatialProcessor/IIS/', login: 'jspublic', password: 'jspublic',
                mapWrapper: 'map',
                services: ['osm', 'evergisjs_mrc_test']
            });

            var featureLayer = new sGis.FeatureLayer();


            sp.service.evergisjs_mrc_test.addListner('initialize', function() {
                var clusteringService = new sGis.spatialProcessor.ClusteringService(sp.connector, 'ClusterService', {
                    map: sp.map,
                    layer: featureLayer,
                    storageId: sp.service.evergisjs_mrc_test.layerInfo[0].LayerInfo.storageId,
                    click: function() {
                        alert(this.items.join('\n'));
                    }
                });
            });

            }
    </script>
</body>
</html>
