<!DOCTYPE html>
<html>
<head>
    <title>sGis Framework - Multiple Maps Sample</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">

    <style>
        body, html {margin: 0px; overflow: hidden; height: 100%;}
        div#map {position: absolute; width: 100%; height: 100%;}
    </style>

    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <script src="http://dev2.everpoint.ru/evergis/html5/lib/touchpunch.js"></script>

    <script src="..\Source\sGis\sGis.js"></script>
    <script src="..\Source\sGis\Geotools.js"></script>
    <script src="..\Source\sGis\RBush.js"></script>
    <script src="..\Source\sGis\Event.js"></script>
    <script src="..\Source\sGis\utils.js"></script>
    <script src="..\Source\sGis\utils\utils.js"></script>
    <script src="..\Source\sGis\utils\proto.js"></script>
    <script src="..\Source\sGis\Crs.js"></script>
    <script src="..\Source\sGis\IEventHandler.js"></script>
    <script src="..\Source\sGis\geom.js"></script>
    <script src="..\Source\sGis\Painter.js"></script>
    <script src="..\Source\sGis\Layer.js"></script>
    <script src="..\Source\sGis\LayerGroup.js"></script>
    <script src="..\Source\sGis\Map.js"></script>
    <script src="..\Source\sGis\TileLayer.js"></script>
    <script src="..\Source\sGis\DynamicLayer.js"></script>
    <script src="..\Source\sGis\FeatureLayer.js"></script>
    <script src="..\Source\sGis\ESRIDynamicLayer.js"></script>
    <script src="..\Source\sGis\Decorations.js"></script>
    <script src="..\Source\sGis\geom\Arc.js"></script>
    <script src="..\Source\sGis\geom\Point.js"></script>
    <script src="..\Source\sGis\geom\Polyline.js"></script>
    <script src="..\Source\sGis\geom\Polygon.js"></script>
    <script src="..\Source\sGis\symbols\Symbol.js"></script>
    <script src="..\Source\sGis\symbols\Maptip.js"></script>
    <script src="..\Source\sGis\symbols\Point.js"></script>
    <script src="..\Source\sGis\symbols\Polyline.js"></script>
    <script src="..\Source\sGis\symbols\Polygon.js"></script>
    <script src="..\Source\sGis\features\Feature.js"></script>
    <script src="..\Source\sGis\features\Image.js"></script>
    <script src="..\Source\sGis\features\FeatureGroup.js"></script>
    <script src="..\Source\sGis\features\Point.js"></script>
    <script src="..\Source\sGis\features\Polyline.js"></script>
    <script src="..\Source\sGis\features\Polygon.js"></script>
    <script src="..\Source\sGis\features\Label.js"></script>
    <script src="..\Source\sGis\features\Maptip.js"></script>
    <script src="..\Source\sGis\features\PointGroup.js"></script>
    <script src="..\Source\sGis\controls\Control.js"></script>
    <script src="..\Source\sGis\controls\Point.js"></script>
    <script src="..\Source\sGis\controls\Polyline.js"></script>
    <script src="..\Source\sGis\controls\Polygon.js"></script>
    <script src="..\Source\sGis\controls\Editor.js"></script>
    <script src="..\Source\sGis\controls\Distance.js"></script>
    <script src="..\Source\sGis\controls\Area.js"></script>
    <script src="..\Source\sGis\controls\Rectangle.js"></script>
    <script src="..\Source\sGis\controls\BaseLayerSwitch.js"></script>

    <script src="..\Source\spatialProcessor\Connector.js"></script>
    <script src="..\Source\spatialProcessor\MapServer.js"></script>
    <script src="..\Source\spatialProcessor\DataTree.js"></script>
    <script src="..\Source\spatialProcessor\xmlSerializer.js"></script>
    <script src="..\Source\spatialProcessor\Sfs.js"></script>
    <script src="..\Source\spatialProcessor\Template.js"></script>
    <script src="..\Source\spatialProcessor\Printer.js"></script>
    <script src="..\Source\spatialProcessor\controller\Controller.js"></script>
    <script src="..\Source\spatialProcessor\controller\Identify.js"></script>
    <script src="..\Source\spatialProcessor\controller\SuperSearch.js"></script>
    <script src="..\Source\spatialProcessor\controller\DitIntegration.js"></script>
    <script src="..\Source\spatialProcessor\controller\ClientLayer.js"></script>
    <script src="..\Source\spatialProcessor\controller\DefinitionQuery.js"></script>
    <script src="..\Source\spatialProcessor\controller\TableView.js"></script>
    <script src="..\Source\spatialProcessor\controller\ObjectSelector.js"></script>
    <script src="..\Source\spatialProcessor\DataAccessService.js"></script>

    <script src="..\Source\spatialProcessor\mapItem\MapItem.js"></script>
    <script src="..\Source\spatialProcessor\mapItem\Folder.js"></script>
    <script src="..\Source\spatialProcessor\mapItem\MapServer.js"></script>
    <script src="..\Source\spatialProcessor\mapItem\ClientLayer.js"></script>
    <script src="..\Source\spatialProcessor\mapItem\DynamicServiceLayer.js"></script>

    <script src="..\Source\spatialProcessor\SpatialProcessor.js"></script>

    <script src="..\Source\spatialProcessor\Application.js"></script>

</head>
<body>
<!--

Пример работы с несколькими картами одновременно.

-->

<div id="map"></div>
<script>
    window.onload = function() {

        sGis.spatialProcessor.Connector.prototype.apiLoginUrl = 'http://livingroom/Strategis.JsClient/ApiLogin.aspx';

        var sp = new sGis.SpatialProcessor({
            url: 'http://livingroom/spatialprocessor/',
            login: 'new', password: 'new',
            mapWrapper: 'map',
            baseMaps: [
                {
                    name: 'osm',
                    imageUrl: 'http://dev2.everpoint.ru/EverGIS/Evergis_pictures/OSM_logo.png'
                }
            ],
            services: ['edit_rzu'],
            controllers: ['objectSelector']
        });

        sp.map.on('click', function(e) {
            var poly = new sGis.feature.Polygon([e.point.coordinates, [e.point.x, e.point.y + sp.map.resolution], [e.point.x + sp.map.resolution, e.point.y]], {crs: e.point.crs});
            sp.controller.objectSelector.maxidentify({
                geometry: poly,
                success: function(data) {
                    console.dir(data);
                },
                requested: function() {
                    console.log('req');
                },
                error: function(e) {
                    alert(e);
                }
            });
        });

    }
</script>
</body>
</html>
